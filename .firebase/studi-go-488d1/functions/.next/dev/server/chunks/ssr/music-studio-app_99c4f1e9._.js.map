{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/actions/studio.ts"],"sourcesContent":["\"use server\";\n\nimport {\n    StudioProfile,\n    getAllStudios,\n    getStudioById,\n    saveStudio,\n    createEmptyStudio,\n    deleteStudio\n} from \"@/lib/db-studio\";\nimport { revalidatePath } from \"next/cache\";\n\n// Get All\nexport async function fetchStudios() {\n    return getAllStudios();\n}\n\n// Get One\nexport async function fetchStudio(id: string) {\n    return getStudioById(id);\n}\n\n// Upsert\nexport async function updateStudio(data: StudioProfile) {\n    try {\n        saveStudio(data);\n        revalidatePath(\"/studios\");\n        revalidatePath(`/studios/${data.id}`);\n        return { success: true, message: \"Studio saved successfully.\" };\n    } catch (e: any) {\n        return { success: false, message: e.message };\n    }\n}\n\n// Create New\nexport async function createNewStudioAction() {\n    const newStudio = createEmptyStudio();\n    saveStudio(newStudio);\n    revalidatePath(\"/studios\");\n    return newStudio.id;\n}\n\n// Delete\nexport async function deleteStudioAction(id: string) {\n    deleteStudio(id);\n    revalidatePath(\"/studios\");\n    return { success: true };\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AAQA;;;;;AAGO,eAAe;IAClB,OAAO,IAAA,qKAAa;AACxB;AAGO,eAAe,YAAY,EAAU;IACxC,OAAO,IAAA,qKAAa,EAAC;AACzB;AAGO,eAAe,aAAa,IAAmB;IAClD,IAAI;QACA,IAAA,kKAAU,EAAC;QACX,IAAA,yKAAc,EAAC;QACf,IAAA,yKAAc,EAAC,CAAC,SAAS,EAAE,KAAK,EAAE,EAAE;QACpC,OAAO;YAAE,SAAS;YAAM,SAAS;QAA6B;IAClE,EAAE,OAAO,GAAQ;QACb,OAAO;YAAE,SAAS;YAAO,SAAS,EAAE,OAAO;QAAC;IAChD;AACJ;AAGO,eAAe;IAClB,MAAM,YAAY,IAAA,yKAAiB;IACnC,IAAA,kKAAU,EAAC;IACX,IAAA,yKAAc,EAAC;IACf,OAAO,UAAU,EAAE;AACvB;AAGO,eAAe,mBAAmB,EAAU;IAC/C,IAAA,oKAAY,EAAC;IACb,IAAA,yKAAc,EAAC;IACf,OAAO;QAAE,SAAS;IAAK;AAC3B;;;IAlCsB;IAKA;IAKA;IAYA;IAQA;;AA9BA,yQAAA;AAKA,yQAAA;AAKA,yQAAA;AAYA,yQAAA;AAQA,yQAAA"}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/lib/db-local.ts"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\n\nconst DB_PATH = path.join(process.cwd(), 'data', 'bookings.json');\n\nexport interface Booking {\n    id: string;\n    userId: string;\n    studioId: string;\n    roomName?: string;\n    date: string;       // YYYY-MM-DD\n    startTime: string;  // HH:mm\n    durationHours: number;\n    userCount: number;\n    totalPrice: number;\n    status: 'active' | 'cancelled' | 'modified' | 'no_show';\n    createdAt: string;\n    isPersonalPractice?: boolean;\n}\n\n// Initialize DB file if not exists\nif (!fs.existsSync(DB_PATH)) {\n    fs.writeFileSync(DB_PATH, JSON.stringify([], null, 2));\n}\n\nexport const getBookings = (): Booking[] => {\n    try {\n        const data = fs.readFileSync(DB_PATH, 'utf-8');\n        return JSON.parse(data).map((b: any) => ({\n            ...b,\n            status: b.status || 'active' // Backwards compatibility\n        }));\n    } catch (error) {\n        return [];\n    }\n};\n\nexport const getBookingById = (id: string): Booking | undefined => {\n    return getBookings().find(b => b.id === id);\n};\n\nexport const saveBooking = (booking: Booking): void => {\n    const bookings = getBookings();\n    bookings.push(booking);\n    fs.writeFileSync(DB_PATH, JSON.stringify(bookings, null, 2));\n};\n\nexport const updateBooking = (id: string, updates: Partial<Booking>): boolean => {\n    const bookings = getBookings();\n    const index = bookings.findIndex(b => b.id === id);\n    if (index === -1) return false;\n\n    bookings[index] = { ...bookings[index], ...updates };\n    fs.writeFileSync(DB_PATH, JSON.stringify(bookings, null, 2));\n    return true;\n};\n\n// Check for overlaps\nexport const checkAvailability = (studioId: string, roomName: string | undefined, date: string, startTime: string, duration: number, excludeBookingId?: string): boolean => {\n    const bookings = getBookings();\n\n    // Convert new request to minutes from midnight\n    const [startH, startM] = startTime.split(':').map(Number);\n    const newStart = startH * 60 + startM;\n    const newEnd = newStart + (duration * 60);\n\n    // Filter bookings for the same day AND SAME ROOM\n    const conflictingBookings = bookings.filter(b => {\n        if (b.status === 'cancelled') return false; // Ignore cancelled ones\n        if (excludeBookingId && b.id === excludeBookingId) return false; // Skip the one we are modifying\n        if (b.date !== date) return false;\n        if (b.studioId !== studioId) return false;\n        if (roomName && b.roomName && b.roomName !== roomName) return false;\n        return true;\n    });\n\n    for (const b of conflictingBookings) {\n        const [h, m] = b.startTime.split(':').map(Number);\n        const bStart = h * 60 + m;\n        const bEnd = bStart + (b.durationHours * 60);\n\n        if (newStart < bEnd && newEnd > bStart) {\n            return false;\n        }\n    }\n    return true;\n};\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,UAAU,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAiBjD,mCAAmC;AACnC,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,UAAU;IACzB,wGAAE,CAAC,aAAa,CAAC,SAAS,KAAK,SAAS,CAAC,EAAE,EAAE,MAAM;AACvD;AAEO,MAAM,cAAc;IACvB,IAAI;QACA,MAAM,OAAO,wGAAE,CAAC,YAAY,CAAC,SAAS;QACtC,OAAO,KAAK,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,IAAW,CAAC;gBACrC,GAAG,CAAC;gBACJ,QAAQ,EAAE,MAAM,IAAI,SAAS,0BAA0B;YAC3D,CAAC;IACL,EAAE,OAAO,OAAO;QACZ,OAAO,EAAE;IACb;AACJ;AAEO,MAAM,iBAAiB,CAAC;IAC3B,OAAO,cAAc,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;AAC5C;AAEO,MAAM,cAAc,CAAC;IACxB,MAAM,WAAW;IACjB,SAAS,IAAI,CAAC;IACd,wGAAE,CAAC,aAAa,CAAC,SAAS,KAAK,SAAS,CAAC,UAAU,MAAM;AAC7D;AAEO,MAAM,gBAAgB,CAAC,IAAY;IACtC,MAAM,WAAW;IACjB,MAAM,QAAQ,SAAS,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IAC/C,IAAI,UAAU,CAAC,GAAG,OAAO;IAEzB,QAAQ,CAAC,MAAM,GAAG;QAAE,GAAG,QAAQ,CAAC,MAAM;QAAE,GAAG,OAAO;IAAC;IACnD,wGAAE,CAAC,aAAa,CAAC,SAAS,KAAK,SAAS,CAAC,UAAU,MAAM;IACzD,OAAO;AACX;AAGO,MAAM,oBAAoB,CAAC,UAAkB,UAA8B,MAAc,WAAmB,UAAkB;IACjI,MAAM,WAAW;IAEjB,+CAA+C;IAC/C,MAAM,CAAC,QAAQ,OAAO,GAAG,UAAU,KAAK,CAAC,KAAK,GAAG,CAAC;IAClD,MAAM,WAAW,SAAS,KAAK;IAC/B,MAAM,SAAS,WAAY,WAAW;IAEtC,iDAAiD;IACjD,MAAM,sBAAsB,SAAS,MAAM,CAAC,CAAA;QACxC,IAAI,EAAE,MAAM,KAAK,aAAa,OAAO,OAAO,wBAAwB;QACpE,IAAI,oBAAoB,EAAE,EAAE,KAAK,kBAAkB,OAAO,OAAO,gCAAgC;QACjG,IAAI,EAAE,IAAI,KAAK,MAAM,OAAO;QAC5B,IAAI,EAAE,QAAQ,KAAK,UAAU,OAAO;QACpC,IAAI,YAAY,EAAE,QAAQ,IAAI,EAAE,QAAQ,KAAK,UAAU,OAAO;QAC9D,OAAO;IACX;IAEA,KAAK,MAAM,KAAK,oBAAqB;QACjC,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC;QAC1C,MAAM,SAAS,IAAI,KAAK;QACxB,MAAM,OAAO,SAAU,EAAE,aAAa,GAAG;QAEzC,IAAI,WAAW,QAAQ,SAAS,QAAQ;YACpC,OAAO;QACX;IACJ;IACA,OAAO;AACX"}},
    {"offset": {"line": 155, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/actions/admin.ts"],"sourcesContent":["\"use server\";\n\nimport { getBookings } from \"@/lib/db-local\";\n\nexport async function fetchBookings() {\n    // In a real server component, we can just call the DB function directly.\n    // Or expose it as a server action if we need client-side fetching.\n    return getBookings().sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n}\n\nexport async function fetchBookingsByStudio(studioId: string) {\n    const allBookings = getBookings();\n    return allBookings\n        .filter(booking => booking.studioId === studioId)\n        .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n}\n\nimport { updateBooking } from \"@/lib/db-local\";\n\nexport async function updateBookingStatus(id: string, status: 'active' | 'cancelled' | 'modified' | 'no_show') {\n    return updateBooking(id, { status });\n}\n"],"names":[],"mappings":";;;;;;;;;AAEA;;;;AAEO,eAAe;IAClB,yEAAyE;IACzE,mEAAmE;IACnE,OAAO,IAAA,kKAAW,IAAG,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO;AACvG;AAEO,eAAe,sBAAsB,QAAgB;IACxD,MAAM,cAAc,IAAA,kKAAW;IAC/B,OAAO,YACF,MAAM,CAAC,CAAA,UAAW,QAAQ,QAAQ,KAAK,UACvC,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO;AACvF;;AAIO,eAAe,oBAAoB,EAAU,EAAE,MAAuD;IACzG,OAAO,IAAA,oKAAa,EAAC,IAAI;QAAE;IAAO;AACtC;;;IAjBsB;IAMA;IASA;;AAfA,yQAAA;AAMA,yQAAA;AASA,yQAAA"}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/.next-internal/server/app/admin/%28protected%29/studios/%5Bid%5D/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {adminLogout as '001204c5cf63a9b2296f854320112c5a87dcce6e42'} from 'ACTIONS_MODULE0'\nexport {checkAdminAuth as '00437f65ee5b42f956e8ffc66d1cb8f078eb3f7b8f'} from 'ACTIONS_MODULE0'\nexport {getAuthInfo as '0094447a595c8804f1bc342263046c499a9212ef70'} from 'ACTIONS_MODULE0'\nexport {requireAdminAuth as '00fad050e5d6ad0ce3b05eee5af53765577db154bf'} from 'ACTIONS_MODULE0'\nexport {storeLogin as '40f94cb5b752928b50e639d0b94db41445b719e91b'} from 'ACTIONS_MODULE0'\nexport {adminLogin as '6095d9b95f263e7a67fcaf6220fc022a92ad42b253'} from 'ACTIONS_MODULE0'\nexport {adminLogout as '001204c5cf63a9b2296f854320112c5a87dcce6e42'} from 'ACTIONS_MODULE0'\nexport {getAuthInfo as '0094447a595c8804f1bc342263046c499a9212ef70'} from 'ACTIONS_MODULE0'\nexport {fetchStudios as '00de754591fdaf2c4a04b598d8d123785d38cd283a'} from 'ACTIONS_MODULE1'\nexport {fetchStudio as '405932c62487fb452c306955850c3372e60cb81894'} from 'ACTIONS_MODULE1'\nexport {updateStudio as '40a99c7e57f5ffb60c7126b179428ff9a0895705a5'} from 'ACTIONS_MODULE1'\nexport {createNewStudioAction as '00074318368149362b438db185274ca5ef282e82ea'} from 'ACTIONS_MODULE1'\nexport {deleteStudioAction as '40f0b91f465b26951c09a3f17715c967e1276cad01'} from 'ACTIONS_MODULE1'\nexport {fetchBookingsByStudio as '40711a429c985a6caa883c71953552fd7b21e6bbf9'} from 'ACTIONS_MODULE2'\nexport {updateBookingStatus as '608ba7991e12b182ca12b25d2660f06ee1dfa8c61b'} from 'ACTIONS_MODULE2'\n"],"names":[],"mappings":";AAAA;AAQA;AAKA"}}]
}