{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps, getApp } from \"firebase/app\";\nimport { getFirestore } from \"firebase/firestore\";\n\nconst firebaseConfig = {\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\n// Initialize Firebase (Singleton pattern)\nconst app = getApps().length > 0 ? getApp() : initializeApp(firebaseConfig);\nconst db = getFirestore(app);\n\nexport { db };\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;;;AAEA,MAAM,iBAAiB;IACnB,QAAQ,QAAQ,GAAG,CAAC,4BAA4B;IAChD,YAAY,QAAQ,GAAG,CAAC,gCAAgC;IACxD,WAAW,QAAQ,GAAG,CAAC,+BAA+B;IACtD,eAAe,QAAQ,GAAG,CAAC,mCAAmC;IAC9D,mBAAmB,QAAQ,GAAG,CAAC,wCAAwC;IACvE,OAAO,QAAQ,GAAG,CAAC,2BAA2B;AAClD;AAEA,0CAA0C;AAC1C,MAAM,MAAM,IAAA,qMAAO,IAAG,MAAM,GAAG,IAAI,IAAA,oMAAM,MAAK,IAAA,2MAAa,EAAC;AAC5D,MAAM,KAAK,IAAA,2MAAY,EAAC"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/actions/booking.ts"],"sourcesContent":["\"use server\";\n\nimport { db } from \"@/lib/firebase\"; // Ensure this matches your firebase setup path\nimport { collection, addDoc, Timestamp } from \"firebase/firestore\";\n\ninterface BookingRequest {\n    userId: string;\n    studioId: string; // e.g., \"Room A\"\n    date: string; // YYYY-MM-DD\n    startTime: string; // HH:mm\n    durationHours: number;\n    userCount: number;\n    equipmentIds: string[]; // List of equipment IDs\n}\n\ninterface BookingResponse {\n    success: boolean;\n    message: string;\n    price?: number;\n    bookingId?: string;\n}\n\n// Pricing Constants (JPY)\nconst PRICE_BAND_HOURLY = 2500;\nconst PRICE_INDIVIDUAL_HOURLY = 800; // Per person\nconst PRICE_LOCKOUT_FLAT = 20000; // 10+ hours\n\nexport async function createBooking(data: BookingRequest): Promise<BookingResponse> {\n    const { userId, studioId, date, startTime, durationHours, userCount, equipmentIds } = data;\n\n    console.log(\"Processing booking request:\", data);\n\n    // 1. Calculate Price\n    let totalPrice = 0;\n    const bookingDate = new Date(date);\n    const now = new Date();\n\n    // Reset times for date comparison\n    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    const targetDate = new Date(bookingDate.getFullYear(), bookingDate.getMonth(), bookingDate.getDate());\n\n    const isTodayOrTomorrow = targetDate.getTime() === today.getTime() || targetDate.getTime() === tomorrow.getTime();\n\n    // Logic: Lockout\n    if (durationHours >= 10) {\n        totalPrice = PRICE_LOCKOUT_FLAT;\n    }\n    // Logic: Individual Practice (Kojin Renshu)\n    // Usually allow if <= 2 people AND date is today or tomorrow\n    else if (userCount <= 2 && isTodayOrTomorrow) {\n        totalPrice = PRICE_INDIVIDUAL_HOURLY * userCount * durationHours;\n    }\n    // Logic: Band Practice (Standard)\n    else {\n        totalPrice = PRICE_BAND_HOURLY * durationHours;\n    }\n\n    // 2. Database Transaction (Simplified for now using addDoc)\n    // In a real app, we would check for overlap (Inventory Management) here.\n    // We'll skip the complex inventory logic for this constrained step but acknowledge it.\n\n    try {\n        const bookingRef = await addDoc(collection(db, \"bookings\"), {\n            userId,\n            studioId,\n            date: Timestamp.fromDate(bookingDate),\n            startTime,\n            durationHours,\n            userCount,\n            equipmentIds,\n            totalPrice,\n            createdAt: Timestamp.now(),\n            status: \"confirmed\"\n        });\n\n        console.log(\"Booking created with ID:\", bookingRef.id);\n\n        return {\n            success: true,\n            message: \"Booking successful!\",\n            price: totalPrice,\n            bookingId: bookingRef.id\n        };\n\n    } catch (error: any) {\n        console.error(\"Error creating booking:\", error);\n        return {\n            success: false,\n            message: \"Failed to create booking: \" + error.message\n        };\n    }\n}\n"],"names":[],"mappings":";;;;;AAEA,yPAAqC,+CAA+C;AACpF;AAAA;;;;;AAmBA,0BAA0B;AAC1B,MAAM,oBAAoB;AAC1B,MAAM,0BAA0B,KAAK,aAAa;AAClD,MAAM,qBAAqB,OAAO,YAAY;AAEvC,eAAe,cAAc,IAAoB;IACpD,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,aAAa,EAAE,SAAS,EAAE,YAAY,EAAE,GAAG;IAEtF,QAAQ,GAAG,CAAC,+BAA+B;IAE3C,qBAAqB;IACrB,IAAI,aAAa;IACjB,MAAM,cAAc,IAAI,KAAK;IAC7B,MAAM,MAAM,IAAI;IAEhB,kCAAkC;IAClC,MAAM,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO;IACrE,MAAM,WAAW,IAAI,KAAK;IAC1B,SAAS,OAAO,CAAC,SAAS,OAAO,KAAK;IACtC,MAAM,aAAa,IAAI,KAAK,YAAY,WAAW,IAAI,YAAY,QAAQ,IAAI,YAAY,OAAO;IAElG,MAAM,oBAAoB,WAAW,OAAO,OAAO,MAAM,OAAO,MAAM,WAAW,OAAO,OAAO,SAAS,OAAO;IAE/G,iBAAiB;IACjB,IAAI,iBAAiB,IAAI;QACrB,aAAa;IACjB,OAGK,IAAI,aAAa,KAAK,mBAAmB;QAC1C,aAAa,0BAA0B,YAAY;IACvD,OAEK;QACD,aAAa,oBAAoB;IACrC;IAEA,4DAA4D;IAC5D,yEAAyE;IACzE,uFAAuF;IAEvF,IAAI;QACA,MAAM,aAAa,MAAM,IAAA,qMAAM,EAAC,IAAA,yMAAU,EAAC,sJAAE,EAAE,aAAa;YACxD;YACA;YACA,MAAM,wMAAS,CAAC,QAAQ,CAAC;YACzB;YACA;YACA;YACA;YACA;YACA,WAAW,wMAAS,CAAC,GAAG;YACxB,QAAQ;QACZ;QAEA,QAAQ,GAAG,CAAC,4BAA4B,WAAW,EAAE;QAErD,OAAO;YACH,SAAS;YACT,SAAS;YACT,OAAO;YACP,WAAW,WAAW,EAAE;QAC5B;IAEJ,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO;YACH,SAAS;YACT,SAAS,+BAA+B,MAAM,OAAO;QACzD;IACJ;AACJ;;;IAlEsB;;AAAA,yQAAA"}},
    {"offset": {"line": 185, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {createBooking as '40caca3610ff76b0627662db1d5c81852ddbb2cb8f'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}