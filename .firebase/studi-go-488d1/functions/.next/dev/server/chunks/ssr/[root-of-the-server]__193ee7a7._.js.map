{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/lib/db-studio.ts"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport { v4 as uuidv4 } from 'uuid';\n\nconst STUDIO_DB_PATH = path.join(process.cwd(), 'data', 'studios.json');\n\n// --- Types ---\nexport interface TimeSlotPrice {\n    start: string;\n    end: string;\n    price: number;\n}\nexport interface DaySchedule {\n    slots: TimeSlotPrice[];\n}\nexport interface RoomPricing {\n    weekday: DaySchedule;\n    saturday: DaySchedule;\n    sundayHoliday: DaySchedule;\n}\nexport interface Room {\n    id: string; // generated uuid or simple ID\n    name: string;\n    description?: string;\n    images?: string[];\n    pricing: RoomPricing;\n}\nexport interface EquipmentOption {\n    name: string;\n    pricePerHour: number;\n}\nexport interface BusinessHours {\n    weekday: string;\n    saturday: string;\n    sundayHoliday: string;\n}\nexport interface StaffMember {\n    id: string;\n    name: string;\n    email: string;\n    password?: string;\n    role: 'admin' | 'staff';\n    createdAt: string;\n}\n\nexport interface BlacklistEntry {\n    userId: string;\n    userName: string;\n    email?: string;\n    reason: string;\n    createdAt: string;\n}\n\nexport interface StudioProfile {\n    id: string; // UUID\n    storeName: string;\n    companyName?: string;\n    representative: string;\n    representativeEmail?: string;\n    manager: string; // 担当者名 (or using contactPerson)\n    contactPerson: string;\n    contactPersonEmail?: string;\n    postalCode?: string;\n    address: string;\n    phone: string;\n    email: string; // 店舗全体メール\n    businessHours: BusinessHours;\n    url: string;\n    studioCount: number;\n    rooms: Room[];\n    equipmentOptions: EquipmentOption[];\n    options?: string;\n    images?: string[]; // Array of image URLs or base64\n    appealPoint?: string; // Marketing text\n    monthlyRevenueTarget?: number; // Target for Analytics\n    logoUrl?: string; // Studio Logo\n    invoiceNumber?: string; // Qualified Invoice Issuer Number (T-number)\n    staff?: StaffMember[];\n    blacklist?: BlacklistEntry[];\n    createdAt: string;\n}\n\n// Initialize Studio DB as Array\nif (!fs.existsSync(STUDIO_DB_PATH)) {\n    fs.writeFileSync(STUDIO_DB_PATH, JSON.stringify([], null, 2));\n}\n\n// --- Helpers ---\n\nexport const getAllStudios = (): StudioProfile[] => {\n    try {\n        const data = fs.readFileSync(STUDIO_DB_PATH, 'utf-8');\n        return JSON.parse(data);\n    } catch (error) {\n        return [];\n    }\n};\n\nexport const getStudioById = (id: string): StudioProfile | null => {\n    const studios = getAllStudios();\n    return studios.find(s => s.id === id) || null;\n};\n\nexport const saveStudio = (profile: StudioProfile): void => {\n    const studios = getAllStudios();\n    const index = studios.findIndex(s => s.id === profile.id);\n\n    if (index >= 0) {\n        studios[index] = profile;\n    } else {\n        studios.push(profile);\n    }\n\n    fs.writeFileSync(STUDIO_DB_PATH, JSON.stringify(studios, null, 2));\n};\n\nexport const deleteStudio = (id: string): void => {\n    const studios = getAllStudios().filter(s => s.id !== id);\n    fs.writeFileSync(STUDIO_DB_PATH, JSON.stringify(studios, null, 2));\n}\n\nexport const createEmptyStudio = (): StudioProfile => {\n    return {\n        id: uuidv4(),\n        storeName: \"New Studio\",\n        representative: \"\",\n        manager: \"\",\n        contactPerson: \"\",\n        address: \"\",\n        phone: \"\",\n        email: \"\",\n        businessHours: { weekday: \"10:00-22:00\", saturday: \"10:00-22:00\", sundayHoliday: \"10:00-22:00\" },\n        url: \"\",\n        studioCount: 0,\n        rooms: [],\n        equipmentOptions: [],\n        createdAt: new Date().toISOString()\n    };\n};\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;AACA;;;;AAEA,MAAM,iBAAiB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AA8ExD,gCAAgC;AAChC,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,iBAAiB;IAChC,wGAAE,CAAC,aAAa,CAAC,gBAAgB,KAAK,SAAS,CAAC,EAAE,EAAE,MAAM;AAC9D;AAIO,MAAM,gBAAgB;IACzB,IAAI;QACA,MAAM,OAAO,wGAAE,CAAC,YAAY,CAAC,gBAAgB;QAC7C,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAO,OAAO;QACZ,OAAO,EAAE;IACb;AACJ;AAEO,MAAM,gBAAgB,CAAC;IAC1B,MAAM,UAAU;IAChB,OAAO,QAAQ,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,OAAO;AAC7C;AAEO,MAAM,aAAa,CAAC;IACvB,MAAM,UAAU;IAChB,MAAM,QAAQ,QAAQ,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,QAAQ,EAAE;IAExD,IAAI,SAAS,GAAG;QACZ,OAAO,CAAC,MAAM,GAAG;IACrB,OAAO;QACH,QAAQ,IAAI,CAAC;IACjB;IAEA,wGAAE,CAAC,aAAa,CAAC,gBAAgB,KAAK,SAAS,CAAC,SAAS,MAAM;AACnE;AAEO,MAAM,eAAe,CAAC;IACzB,MAAM,UAAU,gBAAgB,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IACrD,wGAAE,CAAC,aAAa,CAAC,gBAAgB,KAAK,SAAS,CAAC,SAAS,MAAM;AACnE;AAEO,MAAM,oBAAoB;IAC7B,OAAO;QACH,IAAI,IAAA,2MAAM;QACV,WAAW;QACX,gBAAgB;QAChB,SAAS;QACT,eAAe;QACf,SAAS;QACT,OAAO;QACP,OAAO;QACP,eAAe;YAAE,SAAS;YAAe,UAAU;YAAe,eAAe;QAAc;QAC/F,KAAK;QACL,aAAa;QACb,OAAO,EAAE;QACT,kBAAkB,EAAE;QACpB,WAAW,IAAI,OAAO,WAAW;IACrC;AACJ"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/actions/studio.ts"],"sourcesContent":["\"use server\";\n\nimport {\n    StudioProfile,\n    getAllStudios,\n    getStudioById,\n    saveStudio,\n    createEmptyStudio,\n    deleteStudio\n} from \"@/lib/db-studio\";\n\n// Get All\nexport async function fetchStudios() {\n    return getAllStudios();\n}\n\n// Get One\nexport async function fetchStudio(id: string) {\n    return getStudioById(id);\n}\n\n// Upsert\nexport async function updateStudio(data: StudioProfile) {\n    try {\n        saveStudio(data);\n        return { success: true, message: \"Studio saved successfully.\" };\n    } catch (e: any) {\n        return { success: false, message: e.message };\n    }\n}\n\n// Create New\nexport async function createNewStudioAction() {\n    const newStudio = createEmptyStudio();\n    saveStudio(newStudio);\n    return newStudio.id;\n}\n\n// Delete\nexport async function deleteStudioAction(id: string) {\n    deleteStudio(id);\n    return { success: true };\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;;;;AAUO,eAAe;IAClB,OAAO,IAAA,qKAAa;AACxB;AAGO,eAAe,YAAY,EAAU;IACxC,OAAO,IAAA,qKAAa,EAAC;AACzB;AAGO,eAAe,aAAa,IAAmB;IAClD,IAAI;QACA,IAAA,kKAAU,EAAC;QACX,OAAO;YAAE,SAAS;YAAM,SAAS;QAA6B;IAClE,EAAE,OAAO,GAAQ;QACb,OAAO;YAAE,SAAS;YAAO,SAAS,EAAE,OAAO;QAAC;IAChD;AACJ;AAGO,eAAe;IAClB,MAAM,YAAY,IAAA,yKAAiB;IACnC,IAAA,kKAAU,EAAC;IACX,OAAO,UAAU,EAAE;AACvB;AAGO,eAAe,mBAAmB,EAAU;IAC/C,IAAA,oKAAY,EAAC;IACb,OAAO;QAAE,SAAS;IAAK;AAC3B;;;IA9BsB;IAKA;IAKA;IAUA;IAOA;;AA3BA,yQAAA;AAKA,yQAAA;AAKA,yQAAA;AAUA,yQAAA;AAOA,yQAAA"}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/actions/login.ts"],"sourcesContent":["\"use server\";\n\nimport { cookies } from 'next/headers';\nimport fs from 'fs';\nimport path from 'path';\n\nconst USERS_DB_PATH = path.join(process.cwd(), 'data', 'users.json');\n\nconst getUsers = (): any[] => {\n    if (!fs.existsSync(USERS_DB_PATH)) return [];\n    try {\n        const data = fs.readFileSync(USERS_DB_PATH, 'utf-8');\n        return JSON.parse(data);\n    } catch {\n        return [];\n    }\n}\n\nexport async function loginAction(formData: FormData) {\n    const email = formData.get('email') as string;\n\n    if (!email) {\n        return { success: false, message: 'メールアドレスを入力してください。' };\n    }\n\n    const users = getUsers();\n    const user = users.find(u => u.email === email);\n\n    if (!user) {\n        return { success: false, message: 'ユーザーが見つかりません。アカウント登録はお済みですか？' };\n    }\n\n    // Set cookie\n    // In a real app, use a secure session token. Here we strictly simulate by storing userId.\n    const cookieStore = await cookies();\n    cookieStore.set('userId', user.id, { httpOnly: true, path: '/' });\n    cookieStore.set('userName', user.name, { httpOnly: false, path: '/' }); // For client usage easily\n\n    return { success: true, message: 'ログインしました。' };\n}\n\nexport async function logoutAction() {\n    const cookieStore = await cookies();\n    cookieStore.delete('userId');\n    cookieStore.delete('userName');\n    return { success: true };\n}\n\nexport async function getCurrentUser() {\n    const cookieStore = await cookies();\n    const userId = cookieStore.get('userId')?.value;\n    if (!userId) return null;\n\n    const users = getUsers();\n    return users.find(u => u.id === userId) || null;\n}\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;;;;;;AAEA,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAEvD,MAAM,WAAW;IACb,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,gBAAgB,OAAO,EAAE;IAC5C,IAAI;QACA,MAAM,OAAO,wGAAE,CAAC,YAAY,CAAC,eAAe;QAC5C,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAM;QACJ,OAAO,EAAE;IACb;AACJ;AAEO,eAAe,YAAY,QAAkB;IAChD,MAAM,QAAQ,SAAS,GAAG,CAAC;IAE3B,IAAI,CAAC,OAAO;QACR,OAAO;YAAE,SAAS;YAAO,SAAS;QAAoB;IAC1D;IAEA,MAAM,QAAQ;IACd,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK;IAEzC,IAAI,CAAC,MAAM;QACP,OAAO;YAAE,SAAS;YAAO,SAAS;QAA+B;IACrE;IAEA,aAAa;IACb,0FAA0F;IAC1F,MAAM,cAAc,MAAM,IAAA,oKAAO;IACjC,YAAY,GAAG,CAAC,UAAU,KAAK,EAAE,EAAE;QAAE,UAAU;QAAM,MAAM;IAAI;IAC/D,YAAY,GAAG,CAAC,YAAY,KAAK,IAAI,EAAE;QAAE,UAAU;QAAO,MAAM;IAAI,IAAI,0BAA0B;IAElG,OAAO;QAAE,SAAS;QAAM,SAAS;IAAY;AACjD;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,oKAAO;IACjC,YAAY,MAAM,CAAC;IACnB,YAAY,MAAM,CAAC;IACnB,OAAO;QAAE,SAAS;IAAK;AAC3B;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,oKAAO;IACjC,MAAM,SAAS,YAAY,GAAG,CAAC,WAAW;IAC1C,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,WAAW;AAC/C;;;IArCsB;IAuBA;IAOA;;AA9BA,yQAAA;AAuBA,yQAAA;AAOA,yQAAA"}},
    {"offset": {"line": 243, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/actions/user.ts"],"sourcesContent":["\"use server\";\n\nimport fs from 'fs';\nimport path from 'path';\nimport { getCurrentUser } from './login';\n\nconst USERS_DB_PATH = path.join(process.cwd(), 'data', 'users.json');\n\nconst getUsers = (): any[] => {\n    if (!fs.existsSync(USERS_DB_PATH)) return [];\n    try {\n        const data = fs.readFileSync(USERS_DB_PATH, 'utf-8');\n        return JSON.parse(data);\n    } catch {\n        return [];\n    }\n};\n\nexport const getUserById = async (id: string) => {\n    const users = getUsers();\n    return users.find(u => u.id === id);\n};\n\nconst saveUsers = (users: any[]) => {\n    fs.writeFileSync(USERS_DB_PATH, JSON.stringify(users, null, 2));\n};\n\nexport async function toggleMyStudioAction(studioId: string) {\n    const currentUser = await getCurrentUser();\n    if (!currentUser) {\n        return { success: false, message: \"Not logged in\" };\n    }\n\n    const users = getUsers();\n    const userIndex = users.findIndex(u => u.id === currentUser.id);\n\n    if (userIndex === -1) {\n        return { success: false, message: \"User not found\" };\n    }\n\n    const user = users[userIndex];\n    const myStudios = user.myStudios || [];\n\n    if (myStudios.includes(studioId)) {\n        user.myStudios = myStudios.filter((id: string) => id !== studioId);\n    } else {\n        user.myStudios = [...myStudios, studioId];\n    }\n\n    // Move updated user to index\n    users[userIndex] = user;\n    saveUsers(users);\n\n    return { success: true, myStudios: user.myStudios };\n}\n\n// Ensure studio is added to My Studios (idempotent, no toggle)\nexport async function addMyStudioAction(studioId: string) {\n    const currentUser = await getCurrentUser();\n    if (!currentUser) {\n        return { success: false, message: \"Not logged in\" };\n    }\n\n    const users = getUsers();\n    const userIndex = users.findIndex(u => u.id === currentUser.id);\n\n    if (userIndex === -1) {\n        return { success: false, message: \"User not found\" };\n    }\n\n    const user = users[userIndex];\n    const myStudios = user.myStudios || [];\n\n    if (!myStudios.includes(studioId)) {\n        user.myStudios = [...myStudios, studioId];\n        users[userIndex] = user;\n        saveUsers(users);\n    }\n\n    return { success: true, myStudios: user.myStudios };\n}\n\nexport async function getMyStudiosAction() {\n    const currentUser = await getCurrentUser();\n    if (!currentUser) return [];\n    return currentUser.myStudios || [];\n}\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AACA;;;;;;AAEA,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAEvD,MAAM,WAAW;IACb,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,gBAAgB,OAAO,EAAE;IAC5C,IAAI;QACA,MAAM,OAAO,wGAAE,CAAC,YAAY,CAAC,eAAe;QAC5C,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAM;QACJ,OAAO,EAAE;IACb;AACJ;AAEO,MAAM,cAAc,OAAO;IAC9B,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;AACpC;AAEA,MAAM,YAAY,CAAC;IACf,wGAAE,CAAC,aAAa,CAAC,eAAe,KAAK,SAAS,CAAC,OAAO,MAAM;AAChE;AAEO,eAAe,qBAAqB,QAAgB;IACvD,MAAM,cAAc,MAAM,IAAA,mKAAc;IACxC,IAAI,CAAC,aAAa;QACd,OAAO;YAAE,SAAS;YAAO,SAAS;QAAgB;IACtD;IAEA,MAAM,QAAQ;IACd,MAAM,YAAY,MAAM,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,YAAY,EAAE;IAE9D,IAAI,cAAc,CAAC,GAAG;QAClB,OAAO;YAAE,SAAS;YAAO,SAAS;QAAiB;IACvD;IAEA,MAAM,OAAO,KAAK,CAAC,UAAU;IAC7B,MAAM,YAAY,KAAK,SAAS,IAAI,EAAE;IAEtC,IAAI,UAAU,QAAQ,CAAC,WAAW;QAC9B,KAAK,SAAS,GAAG,UAAU,MAAM,CAAC,CAAC,KAAe,OAAO;IAC7D,OAAO;QACH,KAAK,SAAS,GAAG;eAAI;YAAW;SAAS;IAC7C;IAEA,6BAA6B;IAC7B,KAAK,CAAC,UAAU,GAAG;IACnB,UAAU;IAEV,OAAO;QAAE,SAAS;QAAM,WAAW,KAAK,SAAS;IAAC;AACtD;AAGO,eAAe,kBAAkB,QAAgB;IACpD,MAAM,cAAc,MAAM,IAAA,mKAAc;IACxC,IAAI,CAAC,aAAa;QACd,OAAO;YAAE,SAAS;YAAO,SAAS;QAAgB;IACtD;IAEA,MAAM,QAAQ;IACd,MAAM,YAAY,MAAM,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,YAAY,EAAE;IAE9D,IAAI,cAAc,CAAC,GAAG;QAClB,OAAO;YAAE,SAAS;YAAO,SAAS;QAAiB;IACvD;IAEA,MAAM,OAAO,KAAK,CAAC,UAAU;IAC7B,MAAM,YAAY,KAAK,SAAS,IAAI,EAAE;IAEtC,IAAI,CAAC,UAAU,QAAQ,CAAC,WAAW;QAC/B,KAAK,SAAS,GAAG;eAAI;YAAW;SAAS;QACzC,KAAK,CAAC,UAAU,GAAG;QACnB,UAAU;IACd;IAEA,OAAO;QAAE,SAAS;QAAM,WAAW,KAAK,SAAS;IAAC;AACtD;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,mKAAc;IACxC,IAAI,CAAC,aAAa,OAAO,EAAE;IAC3B,OAAO,YAAY,SAAS,IAAI,EAAE;AACtC;;;IApEa;IASS;IA8BA;IAyBA;;AAhET,yQAAA;AASS,yQAAA;AA8BA,yQAAA;AAyBA,yQAAA"}},
    {"offset": {"line": 364, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/.next-internal/server/app/my-studios/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {fetchStudios as '00de754591fdaf2c4a04b598d8d123785d38cd283a'} from 'ACTIONS_MODULE0'\nexport {getMyStudiosAction as '00436b83f3e18cfd5d2704e582c2236e657d47885e'} from 'ACTIONS_MODULE1'\nexport {toggleMyStudioAction as '4026afb62eb83ec1ef72dfd1cde9a33c6d0e3c93e6'} from 'ACTIONS_MODULE1'\nexport {getCurrentUser as '00cc83454bde0ebb8f0e5beebe1faab4e0e3d9b85c'} from 'ACTIONS_MODULE2'\nexport {logoutAction as '008a4238b043ec4500f156fcb67d1507ee6b08edb1'} from 'ACTIONS_MODULE2'\n"],"names":[],"mappings":";AAAA;AACA;AAEA"}}]
}