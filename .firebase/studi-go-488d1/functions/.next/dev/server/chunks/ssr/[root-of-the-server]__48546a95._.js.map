{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/actions/login.ts"],"sourcesContent":["\"use server\";\n\nimport { cookies } from 'next/headers';\nimport fs from 'fs';\nimport path from 'path';\n\nconst USERS_DB_PATH = path.join(process.cwd(), 'data', 'users.json');\n\nconst getUsers = (): any[] => {\n    if (!fs.existsSync(USERS_DB_PATH)) return [];\n    try {\n        const data = fs.readFileSync(USERS_DB_PATH, 'utf-8');\n        return JSON.parse(data);\n    } catch {\n        return [];\n    }\n}\n\nexport async function loginAction(formData: FormData) {\n    const email = formData.get('email') as string;\n\n    if (!email) {\n        return { success: false, message: 'メールアドレスを入力してください。' };\n    }\n\n    const users = getUsers();\n    const user = users.find(u => u.email === email);\n\n    if (!user) {\n        return { success: false, message: 'ユーザーが見つかりません。アカウント登録はお済みですか？' };\n    }\n\n    // Set cookie\n    // In a real app, use a secure session token. Here we strictly simulate by storing userId.\n    const cookieStore = await cookies();\n    cookieStore.set('userId', user.id, { httpOnly: true, path: '/' });\n    cookieStore.set('userName', user.name, { httpOnly: false, path: '/' }); // For client usage easily\n\n    return { success: true, message: 'ログインしました。' };\n}\n\nexport async function logoutAction() {\n    const cookieStore = await cookies();\n    cookieStore.delete('userId');\n    cookieStore.delete('userName');\n    return { success: true };\n}\n\nexport async function getCurrentUser() {\n    const cookieStore = await cookies();\n    const userId = cookieStore.get('userId')?.value;\n    if (!userId) return null;\n\n    const users = getUsers();\n    return users.find(u => u.id === userId) || null;\n}\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;;;;;;AAEA,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAEvD,MAAM,WAAW;IACb,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,gBAAgB,OAAO,EAAE;IAC5C,IAAI;QACA,MAAM,OAAO,wGAAE,CAAC,YAAY,CAAC,eAAe;QAC5C,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAM;QACJ,OAAO,EAAE;IACb;AACJ;AAEO,eAAe,YAAY,QAAkB;IAChD,MAAM,QAAQ,SAAS,GAAG,CAAC;IAE3B,IAAI,CAAC,OAAO;QACR,OAAO;YAAE,SAAS;YAAO,SAAS;QAAoB;IAC1D;IAEA,MAAM,QAAQ;IACd,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK;IAEzC,IAAI,CAAC,MAAM;QACP,OAAO;YAAE,SAAS;YAAO,SAAS;QAA+B;IACrE;IAEA,aAAa;IACb,0FAA0F;IAC1F,MAAM,cAAc,MAAM,IAAA,oKAAO;IACjC,YAAY,GAAG,CAAC,UAAU,KAAK,EAAE,EAAE;QAAE,UAAU;QAAM,MAAM;IAAI;IAC/D,YAAY,GAAG,CAAC,YAAY,KAAK,IAAI,EAAE;QAAE,UAAU;QAAO,MAAM;IAAI,IAAI,0BAA0B;IAElG,OAAO;QAAE,SAAS;QAAM,SAAS;IAAY;AACjD;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,oKAAO;IACjC,YAAY,MAAM,CAAC;IACnB,YAAY,MAAM,CAAC;IACnB,OAAO;QAAE,SAAS;IAAK;AAC3B;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,oKAAO;IACjC,MAAM,SAAS,YAAY,GAAG,CAAC,WAAW;IAC1C,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,WAAW;AAC/C;;;IArCsB;IAuBA;IAOA;;AA9BA,yQAAA;AAuBA,yQAAA;AAOA,yQAAA"}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/lib/db-local.ts"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\n\nconst DB_PATH = path.join(process.cwd(), 'data', 'bookings.json');\n\nexport interface Booking {\n    id: string;\n    userId: string;\n    studioId: string;\n    roomName?: string; // Added for detail\n    date: string;       // YYYY-MM-DD\n    startTime: string;  // HH:mm\n    durationHours: number;\n    userCount: number;\n    totalPrice: number;\n    createdAt: string;\n}\n\n// Initialize DB file if not exists\nif (!fs.existsSync(DB_PATH)) {\n    fs.writeFileSync(DB_PATH, JSON.stringify([], null, 2));\n}\n\nexport const getBookings = (): Booking[] => {\n    try {\n        const data = fs.readFileSync(DB_PATH, 'utf-8');\n        return JSON.parse(data);\n    } catch (error) {\n        return [];\n    }\n};\n\nexport const saveBooking = (booking: Booking): void => {\n    const bookings = getBookings();\n    bookings.push(booking);\n    fs.writeFileSync(DB_PATH, JSON.stringify(bookings, null, 2));\n};\n\n// Check for overlaps\nexport const checkAvailability = (studioId: string, roomName: string | undefined, date: string, startTime: string, duration: number): boolean => {\n    const bookings = getBookings();\n\n    // Convert new request to minutes from midnight\n    const [startH, startM] = startTime.split(':').map(Number);\n    const newStart = startH * 60 + startM;\n    const newEnd = newStart + (duration * 60);\n\n    // Filter bookings for the same day AND SAME ROOM\n    const conflictingBookings = bookings.filter(b => {\n        if (b.date !== date) return false;\n        if (b.studioId !== studioId) return false;\n        // If rooms are defined, they must match. If legacy booking has no room, assumption is risky, but let's assume strict match if roomName provided.\n        // For this app, we recently added roomName.\n        if (roomName && b.roomName && b.roomName !== roomName) return false;\n        return true;\n    });\n\n    for (const b of conflictingBookings) {\n        const [h, m] = b.startTime.split(':').map(Number);\n        const bStart = h * 60 + m;\n        const bEnd = bStart + (b.durationHours * 60);\n\n        // Overlap logic: (StartA < EndB) and (EndA > StartB)\n        if (newStart < bEnd && newEnd > bStart) {\n            return false; // Overlap found\n        }\n    }\n    return true; // No overlap\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEA,MAAM,UAAU,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAejD,mCAAmC;AACnC,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,UAAU;IACzB,wGAAE,CAAC,aAAa,CAAC,SAAS,KAAK,SAAS,CAAC,EAAE,EAAE,MAAM;AACvD;AAEO,MAAM,cAAc;IACvB,IAAI;QACA,MAAM,OAAO,wGAAE,CAAC,YAAY,CAAC,SAAS;QACtC,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAO,OAAO;QACZ,OAAO,EAAE;IACb;AACJ;AAEO,MAAM,cAAc,CAAC;IACxB,MAAM,WAAW;IACjB,SAAS,IAAI,CAAC;IACd,wGAAE,CAAC,aAAa,CAAC,SAAS,KAAK,SAAS,CAAC,UAAU,MAAM;AAC7D;AAGO,MAAM,oBAAoB,CAAC,UAAkB,UAA8B,MAAc,WAAmB;IAC/G,MAAM,WAAW;IAEjB,+CAA+C;IAC/C,MAAM,CAAC,QAAQ,OAAO,GAAG,UAAU,KAAK,CAAC,KAAK,GAAG,CAAC;IAClD,MAAM,WAAW,SAAS,KAAK;IAC/B,MAAM,SAAS,WAAY,WAAW;IAEtC,iDAAiD;IACjD,MAAM,sBAAsB,SAAS,MAAM,CAAC,CAAA;QACxC,IAAI,EAAE,IAAI,KAAK,MAAM,OAAO;QAC5B,IAAI,EAAE,QAAQ,KAAK,UAAU,OAAO;QACpC,iJAAiJ;QACjJ,4CAA4C;QAC5C,IAAI,YAAY,EAAE,QAAQ,IAAI,EAAE,QAAQ,KAAK,UAAU,OAAO;QAC9D,OAAO;IACX;IAEA,KAAK,MAAM,KAAK,oBAAqB;QACjC,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC;QAC1C,MAAM,SAAS,IAAI,KAAK;QACxB,MAAM,OAAO,SAAU,EAAE,aAAa,GAAG;QAEzC,qDAAqD;QACrD,IAAI,WAAW,QAAQ,SAAS,QAAQ;YACpC,OAAO,OAAO,gBAAgB;QAClC;IACJ;IACA,OAAO,MAAM,aAAa;AAC9B"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/src/actions/schedule.ts"],"sourcesContent":["\"use server\";\n\nimport { getBookings } from \"@/lib/db-local\";\n\nexport async function getBookingsAction() {\n    const bookings = getBookings();\n    // Re-map or sanitize if needed\n    return bookings;\n}\n"],"names":[],"mappings":";;;;;AAEA;;;;AAEO,eAAe;IAClB,MAAM,WAAW,IAAA,kKAAW;IAC5B,+BAA+B;IAC/B,OAAO;AACX;;;IAJsB;;AAAA,yQAAA"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///Users/fujinoyouichi/music-studio-app/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getCurrentUser as '00cc83454bde0ebb8f0e5beebe1faab4e0e3d9b85c'} from 'ACTIONS_MODULE0'\nexport {getBookingsAction as '0081e40b72fa657e20758eba101347f2368c20b5d7'} from 'ACTIONS_MODULE1'\nexport {logoutAction as '008a4238b043ec4500f156fcb67d1507ee6b08edb1'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA;AACA"}}]
}