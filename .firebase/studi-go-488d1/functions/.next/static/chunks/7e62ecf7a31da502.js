(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52958,e=>{"use strict";var t=e.i(33067),a=e.i(58682);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...s})})}function l({className:e,...s}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...s})}function r({className:e,...s}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...s})}function d({className:e,...s}){return(0,t.jsx)("tfoot",{"data-slot":"table-footer",className:(0,a.cn)("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",e),...s})}function i({className:e,...s}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function c({className:e,...s}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function n({className:e,...s}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function o({className:e,...s}){return(0,t.jsx)("caption",{"data-slot":"table-caption",className:(0,a.cn)("text-muted-foreground mt-4 text-sm",e),...s})}e.s(["Table",()=>s,"TableBody",()=>r,"TableCaption",()=>o,"TableCell",()=>n,"TableFooter",()=>d,"TableHead",()=>c,"TableHeader",()=>l,"TableRow",()=>i])},31048,e=>{"use strict";let t=(0,e.i(81416).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],31048)},22814,e=>{"use strict";let t=(0,e.i(81416).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],22814)},50542,e=>{"use strict";var t=e.i(33067),a=e.i(58682);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function l({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function r({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...s})}function d({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>i,"CardDescription",()=>d,"CardHeader",()=>l,"CardTitle",()=>r])},65276,e=>{"use strict";let t=(0,e.i(81416).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],65276)},69159,e=>{"use strict";var t=e.i(33067),a=e.i(67437),s=e.i(50542),l=e.i(76381),r=e.i(90174),d=e.i(61468),i=e.i(18699),c=e.i(71246),n=e.i(99189),o=e.i(52958),x=e.i(65276),h=e.i(25052),m=e.i(81416);let u=(0,m.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var b=e.i(31048),g=e.i(22814);let j=(0,m.default)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var p=e.i(74714);let v=(0,p.createServerReference)("00422208a51b5663b9e615a47c358d26b4ad0de769",p.callServer,void 0,p.findSourceMapURL,"fetchCoupons"),f=(0,p.createServerReference)("4006ee327384973dc7230516f685a2df53875192d2",p.callServer,void 0,p.findSourceMapURL,"generateCoupon"),N=(0,p.createServerReference)("409094c6682faddea444e16d8079894da6643581c6",p.callServer,void 0,p.findSourceMapURL,"deleteCoupon"),y=(0,p.createServerReference)("0004ce98d57b4e58c117a5709faf9f06f304d07903",p.callServer,void 0,p.findSourceMapURL,"fetchStudios");function w(){let[e,m]=(0,a.useState)([]),[p,w]=(0,a.useState)([]),[C,T]=(0,a.useState)(!0),[S,k]=(0,a.useState)(!1),[U,I]=(0,a.useState)(null),[H,L]=(0,a.useState)({title:"",discountType:"percentage",discountValue:0,maxUses:100,validFrom:"",validUntil:"",targetStudioIds:[]}),F=async()=>{T(!0);let[e,t]=await Promise.all([v(),y()]);m(e),w(t),T(!1)};(0,a.useEffect)(()=>{F()},[]);let R=async e=>{e.preventDefault(),await f(H),k(!1),L({title:"",discountType:"percentage",discountValue:0,maxUses:100,validFrom:"",validUntil:"",targetStudioIds:[]}),F()},B=async e=>{confirm("このクーポンを削除しますか？")&&(await N(e),F())},M=e.filter(e=>e.isActive),V=e.reduce((e,t)=>e+t.usedCount,0);return C?(0,t.jsxs)("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:[(0,t.jsx)(g.Loader2,{className:"animate-spin mr-2"})," Loading..."]}):(0,t.jsx)("div",{className:"min-h-screen bg-black text-white p-10 font-sans",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8 border-b border-white/10 pb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-cyan-400 mb-2",children:"クーポン管理 (Activa)"}),(0,t.jsx)("p",{className:"text-gray-400",children:"割引クーポンの発行・管理を行います"})]}),(0,t.jsxs)(i.Dialog,{open:S,onOpenChange:k,children:[(0,t.jsx)(i.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(l.Button,{className:"bg-cyan-500 hover:bg-cyan-600 text-black font-bold",children:[(0,t.jsx)(x.Plus,{className:"mr-2 h-4 w-4"})," クーポン発行"]})}),(0,t.jsxs)(i.DialogContent,{className:"bg-slate-900 border-white/10 text-white max-w-2xl",children:[(0,t.jsx)(i.DialogHeader,{children:(0,t.jsxs)(i.DialogTitle,{className:"text-cyan-400 flex items-center gap-2",children:[(0,t.jsx)(j,{className:"h-5 w-5"}),"新規クーポン発行"]})}),(0,t.jsxs)("form",{onSubmit:R,className:"space-y-4 mt-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Label,{htmlFor:"title",children:"タイトル"}),(0,t.jsx)(r.Input,{id:"title",value:H.title,onChange:e=>L({...H,title:e.target.value}),className:"bg-slate-800 border-white/10 text-white",placeholder:"例: 新規登録特典",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Label,{htmlFor:"discountType",children:"割引タイプ"}),(0,t.jsxs)(c.Select,{value:H.discountType,onValueChange:e=>L({...H,discountType:e}),children:[(0,t.jsx)(c.SelectTrigger,{className:"bg-slate-800 border-white/10 text-white",children:(0,t.jsx)(c.SelectValue,{})}),(0,t.jsxs)(c.SelectContent,{className:"bg-slate-800 border-white/10 text-white",children:[(0,t.jsx)(c.SelectItem,{value:"percentage",children:"パーセント(%)"}),(0,t.jsx)(c.SelectItem,{value:"fixed",children:"固定額(¥)"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(d.Label,{htmlFor:"discountValue",children:["割引値"," ","percentage"===H.discountType?"(%)":"(¥)"]}),(0,t.jsx)(r.Input,{id:"discountValue",type:"number",value:H.discountValue,onChange:e=>L({...H,discountValue:Number(e.target.value)}),className:"bg-slate-800 border-white/10 text-white",required:!0})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Label,{htmlFor:"maxUses",children:"最大利用回数"}),(0,t.jsx)(r.Input,{id:"maxUses",type:"number",value:H.maxUses,onChange:e=>L({...H,maxUses:Number(e.target.value)}),className:"bg-slate-800 border-white/10 text-white",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Label,{htmlFor:"validFrom",children:"有効開始日"}),(0,t.jsx)(r.Input,{id:"validFrom",type:"date",value:H.validFrom,onChange:e=>L({...H,validFrom:e.target.value}),className:"bg-slate-800 border-white/10 text-white",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Label,{htmlFor:"validUntil",children:"有効終了日"}),(0,t.jsx)(r.Input,{id:"validUntil",type:"date",value:H.validUntil,onChange:e=>L({...H,validUntil:e.target.value}),className:"bg-slate-800 border-white/10 text-white",required:!0})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Label,{children:"対象スタジオ（空欄の場合は全店舗）"}),(0,t.jsxs)("div",{className:"space-y-2 mt-2 max-h-40 overflow-y-auto bg-slate-800 p-3 rounded border border-white/10",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-white/5 p-2 rounded",children:[(0,t.jsx)("input",{type:"checkbox",checked:0===H.targetStudioIds.length,onChange:e=>{e.target.checked&&L({...H,targetStudioIds:[]})},className:"rounded border-white/20"}),(0,t.jsx)("span",{className:"text-sm font-medium text-cyan-400",children:"全店舗"})]}),p.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-white/5 p-2 rounded",children:[(0,t.jsx)("input",{type:"checkbox",checked:H.targetStudioIds.includes(e.id),onChange:t=>{t.target.checked?L({...H,targetStudioIds:[...H.targetStudioIds,e.id]}):L({...H,targetStudioIds:H.targetStudioIds.filter(t=>t!==e.id)})},className:"rounded border-white/20"}),(0,t.jsx)("span",{className:"text-sm",children:e.storeName})]},e.id))]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,t.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>k(!1),className:"border-white/20 text-white hover:bg-white/5",children:"キャンセル"}),(0,t.jsx)(l.Button,{type:"submit",className:"bg-cyan-500 hover:bg-cyan-600 text-black",children:"発行"})]})]})]})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[(0,t.jsxs)(s.Card,{className:"bg-slate-900 border-white/10",children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium text-gray-400",children:"発行済みクーポン"}),(0,t.jsx)(h.Ticket,{className:"h-4 w-4 text-cyan-400"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:e.length})})]}),(0,t.jsxs)(s.Card,{className:"bg-slate-900 border-white/10",children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium text-gray-400",children:"有効なクーポン"}),(0,t.jsx)(b.CheckCircle,{className:"h-4 w-4 text-green-400"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:"text-2xl font-bold text-green-400",children:M.length})})]}),(0,t.jsxs)(s.Card,{className:"bg-slate-900 border-white/10",children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium text-gray-400",children:"総利用回数"}),(0,t.jsx)(j,{className:"h-4 w-4 text-cyan-400"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:V})})]})]}),(0,t.jsx)(s.Card,{className:"bg-slate-900 border-white/10",children:(0,t.jsx)(s.CardContent,{className:"p-0",children:(0,t.jsxs)(o.Table,{children:[(0,t.jsx)(o.TableHeader,{className:"bg-white/5",children:(0,t.jsxs)(o.TableRow,{className:"border-white/10 hover:bg-transparent",children:[(0,t.jsx)(o.TableHead,{className:"text-cyan-400",children:"コード"}),(0,t.jsx)(o.TableHead,{className:"text-cyan-400",children:"タイトル"}),(0,t.jsx)(o.TableHead,{className:"text-cyan-400",children:"割引"}),(0,t.jsx)(o.TableHead,{className:"text-cyan-400",children:"利用状況"}),(0,t.jsx)(o.TableHead,{className:"text-cyan-400",children:"有効期間"}),(0,t.jsx)(o.TableHead,{className:"text-cyan-400",children:"対象"}),(0,t.jsx)(o.TableHead,{className:"text-cyan-400",children:"ステータス"}),(0,t.jsx)(o.TableHead,{className:"text-cyan-400",children:"アクション"})]})}),(0,t.jsx)(o.TableBody,{children:0===e.length?(0,t.jsx)(o.TableRow,{children:(0,t.jsx)(o.TableCell,{colSpan:8,className:"text-center py-10 text-gray-500",children:"クーポンがありません。右上のボタンから発行してください。"})}):e.map(e=>(0,t.jsxs)(o.TableRow,{className:"border-white/10 hover:bg-white/5",children:[(0,t.jsx)(o.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("code",{className:"bg-slate-800 px-2 py-1 rounded text-cyan-400 font-mono text-sm",children:e.code}),(0,t.jsx)(l.Button,{size:"sm",variant:"ghost",onClick:()=>{var t;return t=e.code,void(navigator.clipboard.writeText(t),I(t),setTimeout(()=>I(null),2e3))},className:"h-6 w-6 p-0",children:U===e.code?(0,t.jsx)(b.CheckCircle,{className:"h-3 w-3 text-green-400"}):(0,t.jsx)(u,{className:"h-3 w-3 text-gray-400"})})]})}),(0,t.jsx)(o.TableCell,{className:"text-white",children:e.title}),(0,t.jsx)(o.TableCell,{className:"font-medium text-cyan-400",children:"percentage"===e.discountType?`${e.discountValue}%`:`\xa5${e.discountValue.toLocaleString()}`}),(0,t.jsxs)(o.TableCell,{children:[(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("span",{className:"text-white",children:e.usedCount}),(0,t.jsxs)("span",{className:"text-gray-500",children:[" ","/ ",e.maxUses]})]}),(0,t.jsx)("div",{className:"w-full bg-slate-800 rounded-full h-1.5 mt-1",children:(0,t.jsx)("div",{className:"bg-cyan-500 h-1.5 rounded-full",style:{width:`${e.usedCount/e.maxUses*100}%`}})})]}),(0,t.jsxs)(o.TableCell,{className:"text-sm text-gray-400",children:[(0,t.jsx)("div",{children:e.validFrom}),(0,t.jsxs)("div",{children:["~ ",e.validUntil]})]}),(0,t.jsx)(o.TableCell,{children:(0,t.jsx)(n.Badge,{variant:"outline",className:"border-cyan-500/30 text-cyan-400",children:0===e.targetStudioIds.length?"全店舗":`${e.targetStudioIds.length}店舗`})}),(0,t.jsx)(o.TableCell,{children:e.isActive?(0,t.jsx)(n.Badge,{className:"bg-green-900/30 text-green-400 border-green-500/30",children:"有効"}):(0,t.jsx)(n.Badge,{className:"bg-gray-700/30 text-gray-400 border-gray-500/30",children:"無効"})}),(0,t.jsx)(o.TableCell,{children:(0,t.jsx)(l.Button,{size:"sm",variant:"outline",className:"border-red-500/30 text-red-400 hover:bg-red-900/20",onClick:()=>B(e.id),children:"削除"})})]},e.id))})]})})})]})})}e.s(["default",()=>w],69159)}]);