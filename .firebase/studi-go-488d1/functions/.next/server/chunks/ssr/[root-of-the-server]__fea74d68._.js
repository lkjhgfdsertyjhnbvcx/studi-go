module.exports=[22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},35649,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(68083)},87735,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},66680,(a,b,c)=>{b.exports=a.x("node:crypto",()=>require("node:crypto"))},60330,a=>{"use strict";var b=a.i(66680);let c={randomUUID:b.randomUUID},d=new Uint8Array(256),e=d.length,f=[];for(let a=0;a<256;++a)f.push((a+256).toString(16).slice(1));a.s(["v4",0,function(a,g,h){if(c.randomUUID&&!g&&!a)return c.randomUUID();var i=a,j=h;let k=(i=i||{}).random??i.rng?.()??(e>d.length-16&&((0,b.randomFillSync)(d),e=0),d.slice(e,e+=16));if(k.length<16)throw Error("Random bytes length must be >= 16");if(k[6]=15&k[6]|64,k[8]=63&k[8]|128,g){if((j=j||0)<0||j+16>g.length)throw RangeError(`UUID byte range ${j}:${j+15} is out of buffer bounds`);for(let a=0;a<16;++a)g[j+a]=k[a];return g}return function(a,b=0){return(f[a[b+0]]+f[a[b+1]]+f[a[b+2]]+f[a[b+3]]+"-"+f[a[b+4]]+f[a[b+5]]+"-"+f[a[b+6]]+f[a[b+7]]+"-"+f[a[b+8]]+f[a[b+9]]+"-"+f[a[b+10]]+f[a[b+11]]+f[a[b+12]]+f[a[b+13]]+f[a[b+14]]+f[a[b+15]]).toLowerCase()}(k)}],60330)},83264,a=>{"use strict";var b=a.i(35649),c=a.i(54010),d=a.i(20191),e=a.i(60330);async function f(){return(0,c.getAllStudiosFromFirestore)()}async function g(a){return(0,c.getStudioByIdFromFirestore)(a)}async function h(a){try{return await (0,c.saveStudioToFirestore)(a),(0,d.revalidatePath)("/studios"),(0,d.revalidatePath)(`/studios/${a.id}`),{success:!0,message:"Studio saved successfully."}}catch(a){return{success:!1,message:a.message}}}async function i(){let a={id:(0,e.v4)(),storeName:"New Studio",representative:"",manager:"",contactPerson:"",address:"",phone:"",email:"",businessHours:{weekday:"10:00-22:00",saturday:"10:00-22:00",sundayHoliday:"10:00-22:00"},url:"",studioCount:0,rooms:[],studentDiscount:{enabled:!1,discountType:"amount",value:0},otherDiscounts:[],personalPracticeSettings:{enabled:!0,reservationWindowType:"days",reservationWindowValue:1,maxPeople:2},designSettings:{logoSize:100,backgroundColor:"#000000",backgroundType:"color"},equipmentOptions:[],createdAt:new Date().toISOString()};return await (0,c.saveStudioToFirestore)(a),(0,d.revalidatePath)("/studios"),a.id}async function j(a){return await (0,c.deleteStudioFromFirestore)(a),(0,d.revalidatePath)("/studios"),{success:!0}}(0,a.i(87735).ensureServerEntryExports)([f,g,h,i,j]),(0,b.registerServerReference)(f,"00e4c93b8752da6310062bf7641dee775c057867ca",null),(0,b.registerServerReference)(g,"40f3f415047df7d6f80b4eeb845beddaafcd2f52bb",null),(0,b.registerServerReference)(h,"404b0dc80b6afb3ebc6ef733601d064b54b160fee4",null),(0,b.registerServerReference)(i,"00c0bbb4b1415d1cd7c9373ddf7699da1ac1714148",null),(0,b.registerServerReference)(j,"40273ea227268ba866faf368020cc212388113d420",null),a.s(["createNewStudioAction",()=>i,"deleteStudioAction",()=>j,"fetchStudio",()=>g,"fetchStudios",()=>f,"updateStudio",()=>h])},58280,a=>{"use strict";var b=a.i(54010);let c=async()=>(0,b.getAllBookingsFromFirestore)(),d=async(a,c)=>(0,b.updateBookingInFirestore)(a,c);a.s(["getBookings",0,c,"updateBooking",0,d])},16750,a=>{"use strict";var b=a.i(35649),c=a.i(60330),d=a.i(46548),e=a.i(20191),f=a.i(54010);async function g(){let a=await (0,d.getAuthInfo)();return a.isAdmin?(0,f.getAllPaymentsFromFirestore)():a.studioId?(0,f.getPaymentsByStudioIdFromFirestore)(a.studioId):[]}async function h(a,b){return console.log(`[Email] Reminder to ${b} for ${a}`),{success:!0}}async function i(a){let b={id:(0,c.v4)(),...a,status:"pending",date:new Date().toISOString().split("T")[0],dueDate:new Date(Date.now()+2592e5).toISOString().split("T")[0],createdAt:new Date().toISOString()};return await (0,f.savePaymentToFirestore)(b),(0,e.revalidatePath)("/admin/payments"),{success:!0,paymentId:b.id}}async function j(a,b){(0,e.unstable_noStore)();try{return await (0,f.updatePaymentStatusInFirestore)(a,b),(0,e.revalidatePath)("/admin/payments"),(0,e.revalidatePath)("/admin"),(0,e.revalidatePath)("/","layout"),{success:!0}}catch(a){return{success:!1,message:a.message}}}(0,a.i(87735).ensureServerEntryExports)([g,h,i,j]),(0,b.registerServerReference)(g,"009f17b70098daf14224125eef5f449f02b4fbeb09",null),(0,b.registerServerReference)(h,"60911b2ed54e7b03b6524a5fa565a747434aaa0d15",null),(0,b.registerServerReference)(i,"4047f0a48fc7cb243839ad6a372adc3d871e0cac82",null),(0,b.registerServerReference)(j,"60d71a481981a003059e26521c79853bac1ade54b4",null),a.s(["createPayment",()=>i,"fetchPayments",()=>g,"sendReminderEmail",()=>h,"updatePaymentStatus",()=>j])},24380,a=>{"use strict";var b=a.i(35649),c=a.i(12437),d=a.i(54010);async function e(a){let b=a.get("email"),e=a.get("password");if(!b)return{success:!1,message:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"};let f=(await (0,d.getAllUsersFromFirestore)()).find(a=>a.email===b);return f?f.password?f.password!==e?{success:!1,message:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚"}:((await (0,c.cookies)()).set("__session",JSON.stringify({type:"user",id:f.id,name:f.name}),{httpOnly:!0,secure:!0,path:"/",maxAge:604800}),{success:!0,message:"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸã€‚"}):{success:!1,message:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãŠå¿˜ã‚Œã§ã™ã‹ï¼Ÿã€ã‹ã‚‰è¨­å®šã‚’è¡Œã£ã¦ãã ã•ã„ã€‚"}:{success:!1,message:"ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²ã¯ãŠæ¸ˆã¿ã§ã™ã‹ï¼Ÿ"}}async function f(){return(await (0,c.cookies)()).delete("__session"),{success:!0}}async function g(){let a=await (0,c.cookies)(),b=a.get("__session")?.value;if(!b)return null;try{let a=JSON.parse(b);if("user"!==a.type)return null;return(await (0,d.getAllUsersFromFirestore)()).find(b=>b.id===a.id)||null}catch(a){return null}}(0,a.i(87735).ensureServerEntryExports)([e,f,g]),(0,b.registerServerReference)(e,"40fd6d66984b29bd424bd497fbe1777d05b6a3fb74",null),(0,b.registerServerReference)(f,"009837b3c5fe64d738d0768ba5c33970c0b39a09c2",null),(0,b.registerServerReference)(g,"00fd941a7429035171e0b748ef78c5506f25c02154",null),a.s(["getCurrentUser",()=>g,"loginAction",()=>e,"logoutAction",()=>f])},76177,a=>{"use strict";var b=a.i(35649),c=a.i(24380),d=a.i(54010),e=a.i(87735);let f=async a=>(0,d.getUserByIdFromFirestore)(a);async function g(a){let b=await (0,c.getCurrentUser)();if(!b)return{success:!1,message:"Not logged in"};let e=await (0,d.getUserByIdFromFirestore)(b.id);if(!e)return{success:!1,message:"User not found"};let f=e.myStudios||[];return f.includes(a)?e.myStudios=f.filter(b=>b!==a):e.myStudios=[...f,a],await (0,d.saveUserToFirestore)(e),{success:!0,myStudios:e.myStudios}}async function h(a){let b=await (0,c.getCurrentUser)();if(!b)return{success:!1,message:"Not logged in"};let e=await (0,d.getUserByIdFromFirestore)(b.id);if(!e)return{success:!1,message:"User not found"};let f=e.myStudios||[];return f.includes(a)||(e.myStudios=[...f,a],await (0,d.saveUserToFirestore)(e)),{success:!0,myStudios:e.myStudios}}async function i(){let a=await (0,c.getCurrentUser)();return a&&a.myStudios||[]}(0,e.ensureServerEntryExports)([f,g,h,i]),(0,b.registerServerReference)(f,"403ca1312ea93f7fdec7a89fa7fffd634d584f59b7",null),(0,b.registerServerReference)(g,"401c848a4839b5495e326dbd9527e980e56b2e81d0",null),(0,b.registerServerReference)(h,"40214df9e35c0b93cc6363e09c49015f9b23d89af7",null),(0,b.registerServerReference)(i,"00fe4763763c9e25e7b0c23dc51f4ad6547485b042",null),a.s(["addMyStudioAction",()=>h,"getMyStudiosAction",()=>i,"toggleMyStudioAction",()=>g])},50082,a=>{"use strict";var b=a.i(35649),c=a.i(54010),d=a.i(76177),e=a.i(83264),f=a.i(16750),g=a.i(50872),h=a.i(87735);async function i(a){let{userId:b,studioId:g,roomName:h,date:i,startTime:j,durationHours:k,userCount:l,totalPriceOverride:m}=a;if(!await (0,c.checkAvailabilityFromFirestore)(g,h,i,j,k))return{success:!1,message:"ðŸš« ã“ã®æ™‚é–“å¸¯ã¯æ—¢ã«äºˆç´„ã•ã‚Œã¦ã„ã¾ã™ã€‚åˆ¥ã®æ™‚é–“ã‚’é¸æŠžã—ã¦ãã ã•ã„ã€‚"};let n=await (0,e.fetchStudio)(g);if(a.isPersonalPractice){if(!n?.personalPracticeSettings?.enabled)return{success:!1,message:"å€‹äººç·´ç¿’ã®å—ä»˜ã¯ç¾åœ¨åœæ­¢ã—ã¦ã„ã¾ã™ã€‚"};let a=n.personalPracticeSettings,b=new Date(`${i}T${j}`),c=new Date,d=b.getTime()-c.getTime();if("days"===a.reservationWindowType){if(d/864e5>a.reservationWindowValue)return{success:!1,message:`å€‹äººç·´ç¿’ã¯åˆ©ç”¨æ—¥ã®${a.reservationWindowValue}æ—¥å‰ã‹ã‚‰äºˆç´„å¯èƒ½ã§ã™ã€‚`}}else if(d/36e5>a.reservationWindowValue)return{success:!1,message:`å€‹äººç·´ç¿’ã¯åˆ©ç”¨ã®${a.reservationWindowValue}æ™‚é–“å‰ã‹ã‚‰äºˆç´„å¯èƒ½ã§ã™ã€‚`};if(l>a.maxPeople)return{success:!1,message:`å€‹äººç·´ç¿’ã¯æœ€å¤§${a.maxPeople}åã¾ã§ã§ã™ã€‚`}}let o=0;o=void 0!==m?m:k>=10?2e4:l<=2?800*l*k:2500*k;let p={id:Math.random().toString(36).substring(7),userId:b,studioId:g,roomName:h,date:i,startTime:j,durationHours:k,userCount:l,totalPrice:o,status:"active",createdAt:new Date().toISOString(),isPersonalPractice:a.isPersonalPractice};try{return await (0,c.saveBookingToFirestore)(p),await (0,f.createPayment)({bookingId:p.id,studioId:g,studioName:n?.storeName||"Unknown Studio",userName:"User",userEmail:"",amount:o,paymentMethod:"stripe"}),await (0,d.addMyStudioAction)(g),{success:!0,message:"äºˆç´„ãŒå®Œäº†ã—ã¾ã—ãŸã€‚",price:o,bookingId:p.id}}catch(a){return{success:!1,message:"äºˆç´„ã«å¤±æ•—ã—ã¾ã—ãŸã€‚"}}}async function j(a){return await (0,c.updateBookingInFirestore)(a,{status:"cancelled"})?{success:!0,message:"äºˆç´„ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚"}:{success:!1,message:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸã€‚"}}async function k(a,b){let d=await (0,c.getBookingByIdFromFirestore)(a);if(!d)return{success:!1,message:"äºˆç´„ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚"};let e=b.studioId||d.studioId,f=b.roomName||d.roomName,g=b.date||d.date,h=b.startTime||d.startTime,i=b.durationHours||d.durationHours;return await (0,c.checkAvailabilityFromFirestore)(e,f,g,h,i,a)?await (0,c.updateBookingInFirestore)(a,{...b,status:"modified"})?{success:!0,message:"äºˆç´„ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚"}:{success:!1,message:"äºˆç´„ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸã€‚"}:{success:!1,message:"ðŸš« ã“ã®æ™‚é–“å¸¯ã¯æ—¢ã«äºˆç´„ã•ã‚Œã¦ã„ã¾ã™ã€‚"}}async function l(){let{getCurrentUser:b}=await a.A(65001),d=await b();if(!d)return[];let e=await (0,c.getAllBookingsFromFirestore)(),f=new Map((await (0,c.getAllStudiosFromFirestore)()).map(a=>[a.id,{name:a.storeName,invoice:a.invoiceNumber}])),g=new Map((await (0,c.getAllPaymentsFromFirestore)()).map(a=>[a.bookingId,a.status]));return e.filter(a=>a.userId===d.id).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime()).map(a=>{let b=f.get(a.studioId);return{...a,studioName:b?.name||"Unknown Studio",invoiceNumber:b?.invoice||"",paymentStatus:g.get(a.id)||"pending"}})}new g.Resend(process.env.RESEND_API_KEY),(0,h.ensureServerEntryExports)([i,j,k,l]),(0,b.registerServerReference)(i,"404c77be536b4a3f6cb2e8e84d3a3ffbecbc032d6e",null),(0,b.registerServerReference)(j,"40e52a23ec02f4934ec4cbf15742a1edb8f0ba0e43",null),(0,b.registerServerReference)(k,"60b9ade70d3c57ffe44daa42c6679956674fc101de",null),(0,b.registerServerReference)(l,"001aaeba859f050f484d75f7c922e9dbc2294c9bae",null),a.s(["cancelBookingAction",()=>j,"createBooking",()=>i,"fetchMyBookings",()=>l,"updateBookingAction",()=>k])},82326,a=>{"use strict";var b=a.i(83264),c=a.i(35649),d=a.i(58280);async function e(){return await (0,d.getBookings)()}(0,a.i(87735).ensureServerEntryExports)([e]),(0,c.registerServerReference)(e,"00db229f3d935b9cae0026afd92b33617fa8368817",null);var f=a.i(50082),g=a.i(24380);a.s([],71548),a.i(71548),a.s(["00db229f3d935b9cae0026afd92b33617fa8368817",()=>e,"00fd941a7429035171e0b748ef78c5506f25c02154",()=>g.getCurrentUser,"404c77be536b4a3f6cb2e8e84d3a3ffbecbc032d6e",()=>f.createBooking,"40f3f415047df7d6f80b4eeb845beddaafcd2f52bb",()=>b.fetchStudio],82326)},65001,a=>{a.v(a=>Promise.resolve().then(()=>a(24380)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__fea74d68._.js.map