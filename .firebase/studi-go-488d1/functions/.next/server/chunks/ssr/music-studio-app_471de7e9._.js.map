{"version":3,"sources":["../../../../../music-studio-app/src/actions/studio.ts","../../../../../music-studio-app/src/actions/payment.ts","../../../../../music-studio-app/.next-internal/server/app/admin/%28protected%29/payments/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["\"use server\";\n\nimport {\n    getAllStudiosFromFirestore,\n    getStudioByIdFromFirestore,\n    saveStudioToFirestore,\n    deleteStudioFromFirestore\n} from \"@/lib/db-firestore\";\nimport { StudioProfile } from \"@/lib/db-studio\";\nimport { revalidatePath } from \"next/cache\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n// Get All\nexport async function fetchStudios() {\n    return getAllStudiosFromFirestore();\n}\n\n// Get One\nexport async function fetchStudio(id: string) {\n    return getStudioByIdFromFirestore(id);\n}\n\n// Upsert\nexport async function updateStudio(data: StudioProfile) {\n    try {\n        await saveStudioToFirestore(data);\n        revalidatePath(\"/studios\");\n        revalidatePath(`/studios/${data.id}`);\n        return { success: true, message: \"Studio saved successfully.\" };\n    } catch (e: any) {\n        return { success: false, message: e.message };\n    }\n}\n\n// Create New\nexport async function createNewStudioAction() {\n    const newStudio: StudioProfile = {\n        id: uuidv4(),\n        storeName: \"New Studio\",\n        representative: \"\",\n        manager: \"\",\n        contactPerson: \"\",\n        address: \"\",\n        phone: \"\",\n        email: \"\",\n        businessHours: { weekday: \"10:00-22:00\", saturday: \"10:00-22:00\", sundayHoliday: \"10:00-22:00\" },\n        url: \"\",\n        studioCount: 0,\n        rooms: [],\n        studentDiscount: { enabled: false, discountType: 'amount', value: 0 },\n        otherDiscounts: [],\n        personalPracticeSettings: { enabled: true, reservationWindowType: 'days', reservationWindowValue: 1, maxPeople: 2 },\n        designSettings: { logoSize: 100, backgroundColor: \"#000000\", backgroundType: 'color' },\n        equipmentOptions: [],\n        createdAt: new Date().toISOString()\n    };\n    await saveStudioToFirestore(newStudio);\n    revalidatePath(\"/studios\");\n    return newStudio.id;\n}\n\n// Delete\nexport async function deleteStudioAction(id: string) {\n    await deleteStudioFromFirestore(id);\n    revalidatePath(\"/studios\");\n    return { success: true };\n}\n","\"use server\";\n\nimport { v4 as uuidv4 } from \"uuid\";\nimport { getAuthInfo } from \"./admin-auth\";\nimport { revalidatePath, unstable_noStore as noStore } from \"next/cache\";\nimport {\n    getAllPaymentsFromFirestore,\n    getPaymentsByStudioIdFromFirestore,\n    savePaymentToFirestore,\n    updatePaymentStatusInFirestore\n} from \"@/lib/db-firestore\";\n\nexport interface Payment {\n    id: string;\n    bookingId: string;\n    studioId: string;\n    studioName: string;\n    userName: string;\n    userEmail: string;\n    userPhone?: string;\n    amount: number;\n    status: \"paid\" | \"pending\" | \"failed\";\n    paymentMethod: \"stripe\" | \"credit\" | \"other\" | \"bank_transfer\";\n    date: string;\n    dueDate?: string;\n    createdAt: string;\n}\n\nexport async function fetchPayments(): Promise<any[]> {\n    const auth = await getAuthInfo();\n\n    if (auth.isAdmin) {\n        return getAllPaymentsFromFirestore();\n    }\n    if (auth.studioId) {\n        return getPaymentsByStudioIdFromFirestore(auth.studioId);\n    }\n    return [];\n}\n\nexport async function sendReminderEmail(paymentId: string, email: string) {\n    console.log(`[Email] Reminder to ${email} for ${paymentId}`);\n    return { success: true };\n}\n\nexport async function createPayment(data: any) {\n    const newPayment: Payment = {\n        id: uuidv4(),\n        ...data,\n        status: \"pending\",\n        date: new Date().toISOString().split(\"T\")[0],\n        dueDate: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString().split(\"T\")[0],\n        createdAt: new Date().toISOString(),\n    };\n\n    await savePaymentToFirestore(newPayment);\n    revalidatePath(\"/admin/payments\");\n    return { success: true, paymentId: newPayment.id };\n}\n\nexport async function updatePaymentStatus(paymentId: string, status: \"paid\" | \"pending\" | \"failed\") {\n    noStore();\n    try {\n        await updatePaymentStatusInFirestore(paymentId, status);\n        revalidatePath(\"/admin/payments\");\n        revalidatePath(\"/admin\");\n        revalidatePath(\"/\", \"layout\");\n        return { success: true };\n    } catch (error: any) {\n        return { success: false, message: error.message };\n    }\n}\n","export {adminLogout as '006af075316706db006bce5619a543b7baa153f247'} from 'ACTIONS_MODULE0'\nexport {getAuthInfo as '0085772fd2329d46f7302aede12ceb7d687cfee89e'} from 'ACTIONS_MODULE0'\nexport {checkAdminAuth as '0089a1f7cb2a7fadf26749d87f9fcdbc1f15b236d8'} from 'ACTIONS_MODULE0'\nexport {requireAdminAuth as '00cc8a2f516f8fd155c8dc632b4a1c0a38dab84afa'} from 'ACTIONS_MODULE0'\nexport {storeLogin as '40530a7c11e54431ea05abc98c22a440f2a6e9ff9a'} from 'ACTIONS_MODULE0'\nexport {adminLogin as '60dc2d980d08fe70a6632f1c2387a539aa45c05dbf'} from 'ACTIONS_MODULE0'\nexport {adminLogout as '006af075316706db006bce5619a543b7baa153f247'} from 'ACTIONS_MODULE0'\nexport {getAuthInfo as '0085772fd2329d46f7302aede12ceb7d687cfee89e'} from 'ACTIONS_MODULE0'\nexport {fetchStudios as '00e4c93b8752da6310062bf7641dee775c057867ca'} from 'ACTIONS_MODULE1'\nexport {fetchStudio as '40f3f415047df7d6f80b4eeb845beddaafcd2f52bb'} from 'ACTIONS_MODULE1'\nexport {updateStudio as '404b0dc80b6afb3ebc6ef733601d064b54b160fee4'} from 'ACTIONS_MODULE1'\nexport {createNewStudioAction as '00c0bbb4b1415d1cd7c9373ddf7699da1ac1714148'} from 'ACTIONS_MODULE1'\nexport {deleteStudioAction as '40273ea227268ba866faf368020cc212388113d420'} from 'ACTIONS_MODULE1'\nexport {fetchPayments as '009f17b70098daf14224125eef5f449f02b4fbeb09'} from 'ACTIONS_MODULE2'\nexport {createPayment as '4047f0a48fc7cb243839ad6a372adc3d871e0cac82'} from 'ACTIONS_MODULE2'\nexport {sendReminderEmail as '60911b2ed54e7b03b6524a5fa565a747434aaa0d15'} from 'ACTIONS_MODULE2'\nexport {updatePaymentStatus as '60d71a481981a003059e26521c79853bac1ade54b4'} from 'ACTIONS_MODULE2'\nexport {sendReminderEmail as '60911b2ed54e7b03b6524a5fa565a747434aaa0d15'} from 'ACTIONS_MODULE2'\nexport {updatePaymentStatus as '60d71a481981a003059e26521c79853bac1ade54b4'} from 'ACTIONS_MODULE2'\n"],"names":[],"mappings":"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"}