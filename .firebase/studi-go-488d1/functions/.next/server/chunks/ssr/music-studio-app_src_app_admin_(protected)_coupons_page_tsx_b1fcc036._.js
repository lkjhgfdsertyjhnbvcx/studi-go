module.exports=[38332,a=>{"use strict";var b=a.i(15334),c=a.i(66757),d=a.i(4715),e=a.i(10425),f=a.i(97438),g=a.i(11866),h=a.i(34183),i=a.i(86378),j=a.i(86176),k=a.i(73992),l=a.i(89799),m=a.i(33294),n=a.i(13035);let o=(0,n.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var p=a.i(50507),q=a.i(50048);let r=(0,n.default)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var s=a.i(10623);let t=(0,s.createServerReference)("00422208a51b5663b9e615a47c358d26b4ad0de769",s.callServer,void 0,s.findSourceMapURL,"fetchCoupons"),u=(0,s.createServerReference)("4006ee327384973dc7230516f685a2df53875192d2",s.callServer,void 0,s.findSourceMapURL,"generateCoupon"),v=(0,s.createServerReference)("409094c6682faddea444e16d8079894da6643581c6",s.callServer,void 0,s.findSourceMapURL,"deleteCoupon"),w=(0,s.createServerReference)("0004ce98d57b4e58c117a5709faf9f06f304d07903",s.callServer,void 0,s.findSourceMapURL,"fetchStudios");function x(){let[a,n]=(0,c.useState)([]),[s,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)({title:"",discountType:"percentage",discountValue:0,maxUses:100,validFrom:"",validUntil:"",targetStudioIds:[]}),G=async()=>{z(!0);let[a,b]=await Promise.all([t(),w()]);n(a),x(b),z(!1)};(0,c.useEffect)(()=>{G()},[]);let H=async a=>{a.preventDefault(),await u(E),B(!1),F({title:"",discountType:"percentage",discountValue:0,maxUses:100,validFrom:"",validUntil:"",targetStudioIds:[]}),G()},I=async a=>{confirm("このクーポンを削除しますか？")&&(await v(a),G())},J=a.filter(a=>a.isActive),K=a.reduce((a,b)=>a+b.usedCount,0);return y?(0,b.jsxs)("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:[(0,b.jsx)(q.Loader2,{className:"animate-spin mr-2"})," Loading..."]}):(0,b.jsx)("div",{className:"min-h-screen bg-black text-white p-10 font-sans",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-8 border-b border-white/10 pb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-cyan-400 mb-2",children:"クーポン管理 (Activa)"}),(0,b.jsx)("p",{className:"text-gray-400",children:"割引クーポンの発行・管理を行います"})]}),(0,b.jsxs)(h.Dialog,{open:A,onOpenChange:B,children:[(0,b.jsx)(h.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{className:"bg-cyan-500 hover:bg-cyan-600 text-black font-bold",children:[(0,b.jsx)(l.Plus,{className:"mr-2 h-4 w-4"})," クーポン発行"]})}),(0,b.jsxs)(h.DialogContent,{className:"bg-slate-900 border-white/10 text-white max-w-2xl",children:[(0,b.jsx)(h.DialogHeader,{children:(0,b.jsxs)(h.DialogTitle,{className:"text-cyan-400 flex items-center gap-2",children:[(0,b.jsx)(r,{className:"h-5 w-5"}),"新規クーポン発行"]})}),(0,b.jsxs)("form",{onSubmit:H,className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"title",children:"タイトル"}),(0,b.jsx)(f.Input,{id:"title",value:E.title,onChange:a=>F({...E,title:a.target.value}),className:"bg-slate-800 border-white/10 text-white",placeholder:"例: 新規登録特典",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"discountType",children:"割引タイプ"}),(0,b.jsxs)(i.Select,{value:E.discountType,onValueChange:a=>F({...E,discountType:a}),children:[(0,b.jsx)(i.SelectTrigger,{className:"bg-slate-800 border-white/10 text-white",children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsxs)(i.SelectContent,{className:"bg-slate-800 border-white/10 text-white",children:[(0,b.jsx)(i.SelectItem,{value:"percentage",children:"パーセント(%)"}),(0,b.jsx)(i.SelectItem,{value:"fixed",children:"固定額(¥)"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(g.Label,{htmlFor:"discountValue",children:["割引値"," ","percentage"===E.discountType?"(%)":"(¥)"]}),(0,b.jsx)(f.Input,{id:"discountValue",type:"number",value:E.discountValue,onChange:a=>F({...E,discountValue:Number(a.target.value)}),className:"bg-slate-800 border-white/10 text-white",required:!0})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"maxUses",children:"最大利用回数"}),(0,b.jsx)(f.Input,{id:"maxUses",type:"number",value:E.maxUses,onChange:a=>F({...E,maxUses:Number(a.target.value)}),className:"bg-slate-800 border-white/10 text-white",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"validFrom",children:"有効開始日"}),(0,b.jsx)(f.Input,{id:"validFrom",type:"date",value:E.validFrom,onChange:a=>F({...E,validFrom:a.target.value}),className:"bg-slate-800 border-white/10 text-white",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"validUntil",children:"有効終了日"}),(0,b.jsx)(f.Input,{id:"validUntil",type:"date",value:E.validUntil,onChange:a=>F({...E,validUntil:a.target.value}),className:"bg-slate-800 border-white/10 text-white",required:!0})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"対象スタジオ（空欄の場合は全店舗）"}),(0,b.jsxs)("div",{className:"space-y-2 mt-2 max-h-40 overflow-y-auto bg-slate-800 p-3 rounded border border-white/10",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-white/5 p-2 rounded",children:[(0,b.jsx)("input",{type:"checkbox",checked:0===E.targetStudioIds.length,onChange:a=>{a.target.checked&&F({...E,targetStudioIds:[]})},className:"rounded border-white/20"}),(0,b.jsx)("span",{className:"text-sm font-medium text-cyan-400",children:"全店舗"})]}),s.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-white/5 p-2 rounded",children:[(0,b.jsx)("input",{type:"checkbox",checked:E.targetStudioIds.includes(a.id),onChange:b=>{b.target.checked?F({...E,targetStudioIds:[...E.targetStudioIds,a.id]}):F({...E,targetStudioIds:E.targetStudioIds.filter(b=>b!==a.id)})},className:"rounded border-white/20"}),(0,b.jsx)("span",{className:"text-sm",children:a.storeName})]},a.id))]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>B(!1),className:"border-white/20 text-white hover:bg-white/5",children:"キャンセル"}),(0,b.jsx)(e.Button,{type:"submit",className:"bg-cyan-500 hover:bg-cyan-600 text-black",children:"発行"})]})]})]})]})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[(0,b.jsxs)(d.Card,{className:"bg-slate-900 border-white/10",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-gray-400",children:"発行済みクーポン"}),(0,b.jsx)(m.Ticket,{className:"h-4 w-4 text-cyan-400"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-white",children:a.length})})]}),(0,b.jsxs)(d.Card,{className:"bg-slate-900 border-white/10",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-gray-400",children:"有効なクーポン"}),(0,b.jsx)(p.CheckCircle,{className:"h-4 w-4 text-green-400"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-green-400",children:J.length})})]}),(0,b.jsxs)(d.Card,{className:"bg-slate-900 border-white/10",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-gray-400",children:"総利用回数"}),(0,b.jsx)(r,{className:"h-4 w-4 text-cyan-400"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-white",children:K})})]})]}),(0,b.jsx)(d.Card,{className:"bg-slate-900 border-white/10",children:(0,b.jsx)(d.CardContent,{className:"p-0",children:(0,b.jsxs)(k.Table,{children:[(0,b.jsx)(k.TableHeader,{className:"bg-white/5",children:(0,b.jsxs)(k.TableRow,{className:"border-white/10 hover:bg-transparent",children:[(0,b.jsx)(k.TableHead,{className:"text-cyan-400",children:"コード"}),(0,b.jsx)(k.TableHead,{className:"text-cyan-400",children:"タイトル"}),(0,b.jsx)(k.TableHead,{className:"text-cyan-400",children:"割引"}),(0,b.jsx)(k.TableHead,{className:"text-cyan-400",children:"利用状況"}),(0,b.jsx)(k.TableHead,{className:"text-cyan-400",children:"有効期間"}),(0,b.jsx)(k.TableHead,{className:"text-cyan-400",children:"対象"}),(0,b.jsx)(k.TableHead,{className:"text-cyan-400",children:"ステータス"}),(0,b.jsx)(k.TableHead,{className:"text-cyan-400",children:"アクション"})]})}),(0,b.jsx)(k.TableBody,{children:0===a.length?(0,b.jsx)(k.TableRow,{children:(0,b.jsx)(k.TableCell,{colSpan:8,className:"text-center py-10 text-gray-500",children:"クーポンがありません。右上のボタンから発行してください。"})}):a.map(a=>(0,b.jsxs)(k.TableRow,{className:"border-white/10 hover:bg-white/5",children:[(0,b.jsx)(k.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("code",{className:"bg-slate-800 px-2 py-1 rounded text-cyan-400 font-mono text-sm",children:a.code}),(0,b.jsx)(e.Button,{size:"sm",variant:"ghost",onClick:()=>{var b;return b=a.code,void(navigator.clipboard.writeText(b),D(b),setTimeout(()=>D(null),2e3))},className:"h-6 w-6 p-0",children:C===a.code?(0,b.jsx)(p.CheckCircle,{className:"h-3 w-3 text-green-400"}):(0,b.jsx)(o,{className:"h-3 w-3 text-gray-400"})})]})}),(0,b.jsx)(k.TableCell,{className:"text-white",children:a.title}),(0,b.jsx)(k.TableCell,{className:"font-medium text-cyan-400",children:"percentage"===a.discountType?`${a.discountValue}%`:`\xa5${a.discountValue.toLocaleString()}`}),(0,b.jsxs)(k.TableCell,{children:[(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("span",{className:"text-white",children:a.usedCount}),(0,b.jsxs)("span",{className:"text-gray-500",children:[" ","/ ",a.maxUses]})]}),(0,b.jsx)("div",{className:"w-full bg-slate-800 rounded-full h-1.5 mt-1",children:(0,b.jsx)("div",{className:"bg-cyan-500 h-1.5 rounded-full",style:{width:`${a.usedCount/a.maxUses*100}%`}})})]}),(0,b.jsxs)(k.TableCell,{className:"text-sm text-gray-400",children:[(0,b.jsx)("div",{children:a.validFrom}),(0,b.jsxs)("div",{children:["~ ",a.validUntil]})]}),(0,b.jsx)(k.TableCell,{children:(0,b.jsx)(j.Badge,{variant:"outline",className:"border-cyan-500/30 text-cyan-400",children:0===a.targetStudioIds.length?"全店舗":`${a.targetStudioIds.length}店舗`})}),(0,b.jsx)(k.TableCell,{children:a.isActive?(0,b.jsx)(j.Badge,{className:"bg-green-900/30 text-green-400 border-green-500/30",children:"有効"}):(0,b.jsx)(j.Badge,{className:"bg-gray-700/30 text-gray-400 border-gray-500/30",children:"無効"})}),(0,b.jsx)(k.TableCell,{children:(0,b.jsx)(e.Button,{size:"sm",variant:"outline",className:"border-red-500/30 text-red-400 hover:bg-red-900/20",onClick:()=>I(a.id),children:"削除"})})]},a.id))})]})})})]})})}a.s(["default",()=>x],38332)}];

//# sourceMappingURL=music-studio-app_src_app_admin_%28protected%29_coupons_page_tsx_b1fcc036._.js.map